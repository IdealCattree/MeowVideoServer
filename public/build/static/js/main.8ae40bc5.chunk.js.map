{"version":3,"sources":["pages/Home.tsx","components/ImageUpload.tsx","components/MovieForm.tsx","services/MovieService.ts","pages/movie/EditMovie.tsx","pages/movie/AddMovie.tsx","services/CommonTypes.ts","assets/none.jpg","components/MovieTable.tsx","redux/actions/MovieAction.ts","container/MovieTableContainer.ts","pages/movie/MovieList.tsx","pages/Layout.tsx","redux/reducers/MovieReducer.ts","redux/reducers/index.ts","redux/index.ts","App.tsx","index.tsx"],"names":["Home","Component","ImageUpload","state","isShowModel","this","props","value","PlusOutlined","name","uid","url","p","formData","FormData","append","file","request","Request","action","method","body","fetch","then","resp","json","res","status","onChange","data","message","error","listType","fileList","getFileList","accept","customRequest","handleChange","onPreview","setState","onRemove","getUploadContent","visible","onCancel","footer","alt","style","width","src","React","formItemLayout","labelCol","span","wrapperCol","offset","AreaAll","label","TypesAll","withRouter","Form","useForm","form","setFieldsValue","useEffect","movie","handleSuccess","a","onSubmit","success","history","push","onFinish","onFinishFailed","Item","hasFeedback","rules","required","Group","options","min","keyboard","valuePropName","initialValue","TextArea","type","htmlType","MovieService","axios","post","id","put","delete","get","condition","params","EditMovie","undefined","findMovieById","match","updateMovie","msg","AddMovie","addMovie","SwitchTypes","MovieTable","onLoad","title","dataIndex","render","poster","className","filterDropdown","padding","key","e","onChangeKey","target","onPressEnter","onSearch","marginBottom","display","size","onClick","filterIcon","SearchOutlined","text","join","record","checked","newValue","onSwitchChange","isHot","_id","isComing","isClassic","to","onConfirm","deleteChange","okText","cancelText","danger","total","pageSize","limit","current","page","showSizeChanger","scroll","x","y","pagination","getPagination","newPage","onPageChange","dataSource","rowKey","columns","getMovieProp","loading","isLoading","setLoadingAction","payload","setConditionAction","deleteMovieAction","switchChangeAction","fetchMovies","dispatch","getState","newCondition","Movie","findMovies","movies","deleteMovie","connect","switchChange","MovieList","MovieTableContainer","_Layout","Header","Layout","Sider","Content","theme","path","exact","component","initialState","totalPage","saveMovie","Math","ceil","filter","m","setCondition","setLoading","find","newMovie","newData","map","d","combineReducers","store","createStore","reducer","applyMiddleware","thunk","logger","App","ReactDOM","document","getElementById"],"mappings":"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","file":"static/js/main.8ae40bc5.chunk.js","sourcesContent":["import React, { Component } from \"react\";\r\n\r\nexport default class Home extends Component {\r\n  render() {\r\n    return (\r\n      <div>\r\n        <h1>欢迎使用猫眼电影管理系统</h1>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import React, { ReactNode } from \"react\";\r\nimport { message, Modal, Upload } from \"antd\";\r\nimport { PlusOutlined } from \"@ant-design/icons\";\r\nimport { UploadFile } from \"antd/lib/upload/interface\";\r\nimport { IResponseData, IResponseError } from \"../services/CommonTypes\";\r\n\r\ninterface IState {\r\n  isShowModel: boolean;\r\n}\r\n\r\ninterface IProps {\r\n  value?: string;\r\n  onChange?: (imgurl: string) => void;\r\n}\r\nexport default class ImageUpload extends React.Component<IProps, IState> {\r\n  state: IState = {\r\n    isShowModel: false,\r\n  };\r\n\r\n  /**\r\n   * 获取上传图片区域的元素\r\n   * @returns\r\n   */\r\n  private getUploadContent(): ReactNode {\r\n    if (this.props.value) {\r\n      return null;\r\n    } else {\r\n      return (\r\n        <div>\r\n          <PlusOutlined />\r\n          <h1>点击上传</h1>\r\n        </div>\r\n      );\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 获取图片列表\r\n   * @returns\r\n   */\r\n  private getFileList(): UploadFile<any>[] {\r\n    if (this.props.value) {\r\n      return [\r\n        {\r\n          name: this.props.value,\r\n          uid: this.props.value,\r\n          url: this.props.value,\r\n        },\r\n      ];\r\n    } else {\r\n      return [];\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 上传图片触发的函数\r\n   * @param p\r\n   */\r\n  private async handleChange(p: any) {\r\n    // 创建一个formdata用于存储图片\r\n    let formData = new FormData();\r\n    formData.append(\"imgfile\", p.file);\r\n\r\n    // 发送图片的request对象\r\n    const request = new Request(p.action, {\r\n      method: \"post\",\r\n      body: formData,\r\n    });\r\n\r\n    const res: IResponseData<string> | IResponseError = await fetch(request).then(resp =>\r\n      resp.json()\r\n    );\r\n\r\n    if (res.status === 200) {\r\n      if (this.props.onChange) {\r\n        this.props.onChange(res.data!);\r\n      }\r\n    } else {\r\n      message.error(\"上传失败\");\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div>\r\n        <Upload\r\n          name=\"imgfile\"\r\n          listType=\"picture-card\"\r\n          action=\"/api/upload\"\r\n          fileList={this.getFileList()}\r\n          accept=\"image/png,image/jpeg,image/jif,image/jiff,image/webg\"\r\n          customRequest={(p: any) => {\r\n            this.handleChange(p);\r\n          }}\r\n          onPreview={() => {\r\n            this.setState({\r\n              isShowModel: true,\r\n            });\r\n          }}\r\n          onRemove={() => {\r\n            if (this.props.onChange) {\r\n              this.props.onChange(\"\");\r\n            }\r\n          }}\r\n        >\r\n          {this.getUploadContent()}\r\n        </Upload>\r\n\r\n        <Modal\r\n          visible={this.state.isShowModel}\r\n          onCancel={() => {\r\n            this.setState({ isShowModel: false });\r\n          }}\r\n          footer={null}\r\n        >\r\n          <img alt=\"\" style={{ width: \"100%\" }} src={this.props.value} />\r\n        </Modal>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import React, { useEffect } from \"react\";\r\nimport { Button, Checkbox, ColProps, Form, Input, InputNumber, message, Switch } from \"antd\";\r\nimport ImageUpload from \"./ImageUpload\";\r\nimport { IMovie } from \"../services/MovieService\";\r\nimport { withRouter, RouteComponentProps } from \"react-router\";\r\n\r\n// 约束表单布局属性的接口\r\ninterface IColProps {\r\n  labelCol: ColProps;\r\n  wrapperCol: ColProps;\r\n}\r\n\r\n// 表单布局的属性\r\nconst formItemLayout: IColProps = {\r\n  labelCol: { span: 4 },\r\n  wrapperCol: { span: 19, offset: 1 },\r\n};\r\n\r\n// 地区多选框的类别\r\nconst AreaAll = [\r\n  { label: \"中国大陆\", value: \"中国大陆\" },\r\n  { label: \"美国\", value: \"美国\" },\r\n  { label: \"中国香港\", value: \"中国香港\" },\r\n  { label: \"中国台湾\", value: \"中国台湾\" },\r\n];\r\n\r\n// 电影类型多选框的类别\r\nconst TypesAll = [\r\n  { label: \"喜剧\", value: \"喜剧\" },\r\n  { label: \"灾难\", value: \"灾难\" },\r\n  { label: \"恐怖\", value: \"恐怖\" },\r\n  { label: \"爱情\", value: \"爱情\" },\r\n  { label: \"动作\", value: \"动作\" },\r\n];\r\n\r\n// 约束 MovieForm函数 属性的接口\r\ninterface IProps extends RouteComponentProps {\r\n  onSubmit: (movie: IMovie) => Promise<string>;\r\n  movie?: IMovie;\r\n}\r\n\r\nfunction MovieForm(props: IProps) {\r\n  // 获取用于表单交互的对象\r\n  const [form] = Form.useForm();\r\n\r\n  // 编辑电影时做数据回填\r\n  const { setFieldsValue } = form;\r\n  useEffect(() => {\r\n    if (props.movie) {\r\n      setFieldsValue(props.movie);\r\n    }\r\n  }, [props.movie, setFieldsValue]);\r\n\r\n  // if (props.movie) {\r\n  //   setFieldsValue(props.movie);\r\n  // }\r\n\r\n  // 提交表单成功的回调函数\r\n  const handleSuccess = async (movie: IMovie) => {\r\n    // submit 返回的是一个字符串  如果成功返回“添加成功” 如果失败返回错误消息\r\n    const res = await props.onSubmit(movie);\r\n    if (res) {\r\n      message.error(res);\r\n    } else {\r\n      message.success(\"处理成功\", 1, () => {\r\n        props.history.push(\"/movie\");\r\n      });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Form\r\n      {...formItemLayout}\r\n      style={{ width: \"400px\" }}\r\n      form={form}\r\n      // 验证成功执行的函数\r\n      onFinish={value => {\r\n        handleSuccess(value);\r\n      }}\r\n      // 验证失败执行的函数\r\n      onFinishFailed={value => {\r\n        message.error(\"提交失败\");\r\n      }}\r\n    >\r\n      <Form.Item name=\"poster\" label=\"电影封面\" hasFeedback>\r\n        <ImageUpload />\r\n      </Form.Item>\r\n\r\n      <Form.Item\r\n        rules={[{ required: true, message: \"电影名不能为空\" }]}\r\n        name=\"name\"\r\n        label=\"电影名称\"\r\n        hasFeedback\r\n      >\r\n        <Input />\r\n      </Form.Item>\r\n\r\n      <Form.Item\r\n        rules={[{ required: true, message: \"地区不能为空\" }]}\r\n        name=\"areas\"\r\n        label=\"地区\"\r\n        hasFeedback\r\n      >\r\n        <Checkbox.Group options={AreaAll} />\r\n      </Form.Item>\r\n\r\n      <Form.Item\r\n        rules={[{ required: true, message: \"类型不能为空\" }]}\r\n        name=\"types\"\r\n        label=\"类型\"\r\n        hasFeedback\r\n      >\r\n        <Checkbox.Group options={TypesAll} />\r\n      </Form.Item>\r\n\r\n      <Form.Item\r\n        rules={[{ required: true, message: \"时长不能为空\" }]}\r\n        name=\"time\"\r\n        label=\"时长\"\r\n        hasFeedback\r\n      >\r\n        <InputNumber min={1} keyboard={true} />\r\n      </Form.Item>\r\n\r\n      <Form.Item\r\n        name=\"isHot\"\r\n        label=\"正在热映\"\r\n        hasFeedback\r\n        valuePropName=\"checked\"\r\n        initialValue={false}\r\n      >\r\n        <Switch />\r\n      </Form.Item>\r\n\r\n      <Form.Item\r\n        name=\"isComing\"\r\n        label=\"即将上映\"\r\n        hasFeedback\r\n        valuePropName=\"checked\"\r\n        initialValue={false}\r\n      >\r\n        <Switch />\r\n      </Form.Item>\r\n\r\n      <Form.Item\r\n        name=\"isClassic\"\r\n        label=\"经典影片\"\r\n        hasFeedback\r\n        valuePropName=\"checked\"\r\n        initialValue={false}\r\n      >\r\n        <Switch />\r\n      </Form.Item>\r\n\r\n      <Form.Item name=\"description\" label=\"简介\">\r\n        <Input.TextArea />\r\n      </Form.Item>\r\n\r\n      <Form.Item labelCol={{ span: 0 }} wrapperCol={{ span: 20, offset: 4 }}>\r\n        <Button type=\"primary\" htmlType=\"submit\">\r\n          提交\r\n        </Button>\r\n      </Form.Item>\r\n    </Form>\r\n  );\r\n}\r\n\r\nexport default withRouter(MovieForm);\r\n","import axios from \"axios\";\r\nimport { IResponseData, IResponseError, IResponsePageData, ISearchCondition } from \"./CommonTypes\";\r\nexport interface IMovie {\r\n  _id?: string;\r\n  name: string;\r\n  types: string[];\r\n  areas: string[];\r\n  time: number;\r\n  isHot: boolean;\r\n  isClassic: boolean;\r\n  isComing: boolean;\r\n  description?: string;\r\n  poster?: string;\r\n}\r\n\r\nexport class MovieService {\r\n  public static async addMovie(movie: IMovie): Promise<IResponseData<IMovie> | IResponseError> {\r\n    const { data } = await axios.post(\"/api/movie\", movie);\r\n    return data;\r\n  }\r\n\r\n  public static async updateMovie(id: string, movie: Partial<IMovie>): Promise<IResponseData<true> | IResponseError> {\r\n    const { data } = await axios.put(\"/api/movie/\" + id, movie);\r\n    return data;\r\n  }\r\n\r\n  public static async deleteMovie(id: string): Promise<IResponseData<true> | IResponseError> {\r\n    const { data } = await axios.delete(\"/api/movie/\" + id);\r\n    return data;\r\n  }\r\n\r\n  public static async findMovieById(id: string): Promise<IResponseData<IMovie | null> | IResponseError> {\r\n    const { data } = await axios.get(\"/api/movie/\" + id);\r\n    return data;\r\n  }\r\n\r\n  public static async findMovies(condition: ISearchCondition): Promise<IResponsePageData<IMovie>> {\r\n    const { data } = await axios.get(\"/api/movie\", {\r\n      params: condition,\r\n    });\r\n    return data;\r\n  }\r\n}\r\n","import React, { Component } from \"react\";\r\nimport { RouteComponentProps } from \"react-router\";\r\nimport MovieForm from \"../../components/MovieForm\";\r\nimport { IMovie, MovieService } from \"../../services/MovieService\";\r\n\r\ninterface IParams {\r\n  id: string;\r\n}\r\ninterface IState {\r\n  movie?: IMovie;\r\n}\r\nexport default class EditMovie extends Component<RouteComponentProps<IParams>, IState> {\r\n  state: IState = {\r\n    movie: undefined,\r\n  };\r\n\r\n  async componentDidMount() {\r\n    const res = await MovieService.findMovieById(this.props.match.params.id);\r\n    if (res.status === 200) {\r\n      this.setState({\r\n        movie: res.data!,\r\n      });\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div>\r\n        <MovieForm\r\n          movie={this.state.movie}\r\n          onSubmit={async movie => {\r\n            const res = await MovieService.updateMovie(this.props.match.params.id, movie);\r\n            if (res.status === 200) {\r\n              return \"\";\r\n            }\r\n            return res.msg;\r\n          }}\r\n        />\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import React from \"react\";\r\nimport MovieForm from \"../../components/MovieForm\";\r\nimport { MovieService } from \"../../services/MovieService\";\r\n\r\nexport default function AddMovie() {\r\n  return (\r\n    <div>\r\n      <MovieForm\r\n        onSubmit={async movie => {\r\n          const resp = await MovieService.addMovie(movie);\r\n          if (resp.status === 200) {\r\n            return \"\";\r\n          }\r\n          return resp.msg;\r\n        }}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n","export interface IResponseData<T> {\r\n  status: number;\r\n  msg: string;\r\n  data: T;\r\n}\r\n\r\nexport interface IResponseError {\r\n  status: number;\r\n  msg: string;\r\n  data: null;\r\n}\r\n\r\nexport interface IResponsePageData<T> {\r\n  status: number;\r\n  msg: string;\r\n  data: T[];\r\n  total: number;\r\n}\r\n\r\nexport interface ISearchCondition {\r\n  page?: number;\r\n  limit?: number;\r\n  key?: string;\r\n}\r\n\r\nexport enum SwitchTypes {\r\n  isHot = \"isHot\",\r\n  isComing = \"isComing\",\r\n  isClassic = \"isClassic\",\r\n}\r\n","export default \"data:image/jpeg;base64,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\"","import React from \"react\";\r\nimport { Button, Popconfirm, Switch, Table, message, Input, Space } from \"antd\";\r\nimport { SearchOutlined } from \"@ant-design/icons\";\r\nimport { IMovieState } from \"../redux/reducers/MovieReducer\";\r\nimport { IMovie } from \"../services/MovieService\";\r\nimport { ColumnsType, TablePaginationConfig } from \"antd/lib/table\";\r\nimport { SwitchTypes } from \"../services/CommonTypes\";\r\nimport defaultPoster from \"../assets/none.jpg\";\r\nimport { NavLink } from \"react-router-dom\";\r\n\r\nexport interface IMovieEvents {\r\n  onLoad: () => void;\r\n  onSwitchChange: (type: SwitchTypes, value: boolean, id: string) => void;\r\n  deleteChange: (id: string) => Promise<void>;\r\n  onPageChange: (newPage: number) => void;\r\n  onChangeKey: (key: string) => void;\r\n  onSearch: () => void;\r\n}\r\n\r\nexport default class MovieTable extends React.Component<IMovieState & IMovieEvents> {\r\n  componentDidMount() {\r\n    this.props.onLoad();\r\n  }\r\n  private getMovieProp(): ColumnsType<IMovie> {\r\n    return [\r\n      {\r\n        title: \"封面\",\r\n        dataIndex: \"poster\",\r\n        render: poster => {\r\n          if (poster) {\r\n            return <img className=\"poster\" src={poster} alt=\"\" />;\r\n          } else {\r\n            return <img className=\"poster\" src={defaultPoster} alt=\"\" />;\r\n          }\r\n        },\r\n      },\r\n      {\r\n        title: \"名称\",\r\n        dataIndex: \"name\",\r\n        filterDropdown: props => {\r\n          return (\r\n            <div style={{ padding: 8 }}>\r\n              <Input\r\n                value={this.props.condition.key}\r\n                onChange={e => {\r\n                  this.props.onChangeKey(e.target.value);\r\n                }}\r\n                onPressEnter={() => {\r\n                  this.props.onSearch();\r\n                }}\r\n                style={{ width: 188, marginBottom: 8, display: \"block\" }}\r\n              />\r\n              <Space>\r\n                <Button\r\n                  type=\"primary\"\r\n                  size=\"small\"\r\n                  style={{ width: 90 }}\r\n                  onClick={() => {\r\n                    this.props.onSearch();\r\n                  }}\r\n                >\r\n                  Search\r\n                </Button>\r\n                <Button\r\n                  size=\"small\"\r\n                  style={{ width: 90 }}\r\n                  onClick={() => {\r\n                    this.props.onChangeKey(\"\");\r\n                    this.props.onSearch();\r\n                  }}\r\n                >\r\n                  Reset\r\n                </Button>\r\n              </Space>\r\n            </div>\r\n          );\r\n        },\r\n        filterIcon: <SearchOutlined />,\r\n      },\r\n      {\r\n        title: \"地区\",\r\n        dataIndex: \"areas\",\r\n        render: (text: string[]) => {\r\n          return text.join(\"，\");\r\n        },\r\n      },\r\n      {\r\n        title: \"类型\",\r\n        dataIndex: \"types\",\r\n        render: (text: string[]) => {\r\n          return text.join(\"，\");\r\n        },\r\n      },\r\n      {\r\n        title: \"时长\",\r\n        dataIndex: \"time\",\r\n        render: (text: number) => {\r\n          return text + \"分钟\";\r\n        },\r\n      },\r\n      {\r\n        title: \"正在热映\",\r\n        dataIndex: \"isHot\",\r\n        render: (text, record) => {\r\n          return (\r\n            <Switch\r\n              checked={text}\r\n              onChange={newValue => {\r\n                this.props.onSwitchChange(SwitchTypes.isHot, newValue, record._id!);\r\n              }}\r\n            />\r\n          );\r\n        },\r\n      },\r\n      {\r\n        title: \"即将上映\",\r\n        dataIndex: \"isComing\",\r\n        render: (text, record) => {\r\n          return (\r\n            <Switch\r\n              checked={text}\r\n              onChange={newValue => {\r\n                this.props.onSwitchChange(SwitchTypes.isComing, newValue, record._id!);\r\n              }}\r\n            />\r\n          );\r\n        },\r\n      },\r\n      {\r\n        title: \"经典影片\",\r\n        dataIndex: \"isClassic\",\r\n        render: (text, record) => {\r\n          return (\r\n            <Switch\r\n              checked={text}\r\n              onChange={newValue => {\r\n                this.props.onSwitchChange(SwitchTypes.isClassic, newValue, record._id!);\r\n              }}\r\n            />\r\n          );\r\n        },\r\n      },\r\n      {\r\n        title: \"操作\",\r\n        dataIndex: \"_id\",\r\n        render: id => {\r\n          return (\r\n            <div>\r\n              <NavLink to={\"/movie/edit/\" + id}>\r\n                <Button type=\"primary\" size=\"small\">\r\n                  编辑\r\n                </Button>\r\n              </NavLink>\r\n              <Popconfirm\r\n                title=\"Are you sure to delete this task?\"\r\n                onConfirm={async () => {\r\n                  await this.props.deleteChange(id);\r\n                  message.success(\"删除成功\");\r\n                }}\r\n                okText=\"确定\"\r\n                cancelText=\"取消\"\r\n              >\r\n                <Button type=\"primary\" danger size=\"small\">\r\n                  删除\r\n                </Button>\r\n              </Popconfirm>\r\n            </div>\r\n          );\r\n        },\r\n      },\r\n    ];\r\n  }\r\n\r\n  private getPagination(): TablePaginationConfig {\r\n    return {\r\n      total: this.props.total,\r\n      pageSize: this.props.condition.limit,\r\n      current: this.props.condition.page,\r\n      showSizeChanger: false,\r\n    };\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div>\r\n        <Table\r\n          scroll={{ x: true, y: \"70vh\" }}\r\n          size=\"small\"\r\n          pagination={this.getPagination()}\r\n          onChange={newPage => {\r\n            this.props.onPageChange(newPage.current!);\r\n          }}\r\n          dataSource={this.props.data}\r\n          rowKey=\"_id\"\r\n          columns={this.getMovieProp()}\r\n          loading={this.props.isLoading}\r\n        />\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import { ISearchCondition, SwitchTypes } from \"../../services/CommonTypes\";\r\nimport { IMovie, MovieService } from \"../../services/MovieService\";\r\nimport { IAction } from \"./ActionTypes\";\r\nimport { ThunkAction } from \"redux-thunk\";\r\nimport { IRootState } from \"../reducers\";\r\n\r\nexport type SaveMovieAction = IAction<\r\n  \"SAVE_MOVIE\",\r\n  {\r\n    movies: IMovie[];\r\n    total: number;\r\n  }\r\n>;\r\nexport function saveMovieAction(movies: IMovie[], total: number): SaveMovieAction {\r\n  return {\r\n    type: \"SAVE_MOVIE\",\r\n    payload: {\r\n      movies,\r\n      total,\r\n    },\r\n  };\r\n}\r\n\r\nexport type SetLoadingAction = IAction<\"SET_LOADING\", boolean>;\r\nexport function setLoadingAction(isLoading: boolean): SetLoadingAction {\r\n  return {\r\n    type: \"SET_LOADING\",\r\n    payload: isLoading,\r\n  };\r\n}\r\n\r\nexport type SetConditionAction = IAction<\"SET_CONDITION\", ISearchCondition>;\r\nexport function setConditionAction(condition: ISearchCondition): SetConditionAction {\r\n  return {\r\n    type: \"SET_CONDITION\",\r\n    payload: condition,\r\n  };\r\n}\r\n\r\nexport type DeleteMovieAction = IAction<\"DELETE_MOVIE\", string>;\r\n/**\r\n * 生产删除电影的action对象\r\n * @param id\r\n * @returns\r\n */\r\nexport function deleteMovieAction(id: string): DeleteMovieAction {\r\n  return {\r\n    type: \"DELETE_MOVIE\",\r\n    payload: id,\r\n  };\r\n}\r\n\r\nexport type SwitchChangeAction = IAction<\"SWITCH_CHANGE\", { type: SwitchTypes; value: boolean; id: string }>;\r\nexport function switchChangeAction(type: SwitchTypes, value: boolean, id: string): SwitchChangeAction {\r\n  return {\r\n    type: \"SWITCH_CHANGE\",\r\n    payload: {\r\n      type,\r\n      value,\r\n      id,\r\n    },\r\n  };\r\n}\r\n\r\nexport type MovieAction = SaveMovieAction | DeleteMovieAction | SetConditionAction | SetLoadingAction | SwitchChangeAction;\r\n\r\n/**\r\n * 请求电影数据\r\n * @param condition\r\n * @returns\r\n */\r\nexport function fetchMovies(condition: ISearchCondition): ThunkAction<Promise<void>, IRootState, any, MovieAction> {\r\n  return async (dispatch, getState) => {\r\n    // 1. 设置加载中的状态\r\n    dispatch(setLoadingAction(true));\r\n    // 2. 设置查询参数的状态\r\n    dispatch(setConditionAction(condition));\r\n    // 3. 向服务器请求数据\r\n    const newCondition = getState().Movie.condition;\r\n    const res = await MovieService.findMovies(newCondition);\r\n    if (res.status === 200) {\r\n      // 4. 设置电影状态\r\n      dispatch(saveMovieAction(res.data, res.total));\r\n    }\r\n    // 5. 设置未加载中的状态\r\n    dispatch(setLoadingAction(false));\r\n  };\r\n}\r\n\r\n/**\r\n * 根据id删除电影\r\n * @param id\r\n * @returns\r\n */\r\nexport function deleteMovie(id: string): ThunkAction<Promise<void>, IRootState, any, MovieAction> {\r\n  return async (dispatch, getState) => {\r\n    dispatch(setLoadingAction(true));\r\n    const res = await MovieService.deleteMovie(id);\r\n    if (res.data === true) {\r\n      dispatch(deleteMovieAction(id));\r\n    }\r\n    dispatch(setLoadingAction(false));\r\n  };\r\n}\r\n\r\n/**\r\n * 触发 切换 正在热映 经典影片 即将上映的状态\r\n * @param type\r\n * @param value\r\n * @param id\r\n * @returns\r\n */\r\nexport function switchChange(type: SwitchTypes, value: boolean, id: string): ThunkAction<Promise<void>, IRootState, any, MovieAction> {\r\n  return async (dispatch, getState) => {\r\n    dispatch(setLoadingAction(true));\r\n    const res = await MovieService.updateMovie(id, {\r\n      [type]: value,\r\n    });\r\n    if (res.status) {\r\n      dispatch(switchChangeAction(type, value, id));\r\n    }\r\n\r\n    dispatch(setLoadingAction(false));\r\n  };\r\n}\r\n","import { connect } from \"react-redux\";\r\nimport { IRootState } from \"../redux/reducers\";\r\nimport MovieTable, { IMovieEvents } from \"../components/MovieTable\";\r\nimport {\r\n  deleteMovie,\r\n  fetchMovies,\r\n  setConditionAction,\r\n  switchChange,\r\n} from \"../redux/actions/MovieAction\";\r\n\r\nfunction mapStateToProps(state: IRootState) {\r\n  return state.Movie;\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: any): IMovieEvents {\r\n  return {\r\n    onLoad() {\r\n      dispatch(\r\n        fetchMovies({\r\n          page: 1,\r\n          limit: 10,\r\n          key: \"\",\r\n        })\r\n      );\r\n    },\r\n    onSwitchChange(type, value, id) {\r\n      dispatch(switchChange(type, value, id));\r\n    },\r\n    async deleteChange(id) {\r\n      await dispatch(deleteMovie(id));\r\n    },\r\n    onPageChange(newPage) {\r\n      dispatch(fetchMovies({ page: newPage }));\r\n    },\r\n    onChangeKey(key) {\r\n      dispatch(\r\n        setConditionAction({\r\n          key,\r\n        })\r\n      );\r\n    },\r\n    onSearch() {\r\n      dispatch(fetchMovies({ page: 1 }));\r\n    },\r\n  };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(MovieTable);\r\n","import React, { Component } from \"react\";\r\nimport MovieTableContainer from \"../../container/MovieTableContainer\";\r\n\r\nexport default class MovieList extends Component {\r\n  render() {\r\n    return (\r\n      <div>\r\n        <MovieTableContainer />\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import React from \"react\";\r\nimport \"./Layout.scss\";\r\nimport { NavLink } from \"react-router-dom\";\r\nimport { Route } from \"react-router\";\r\nimport Home from \"./Home\";\r\nimport EditMovie from \"./movie/EditMovie\";\r\nimport AddMovie from \"./movie/AddMovie\";\r\nimport MovieList from \"./movie/MovieList\";\r\nimport { Layout, Menu } from \"antd\";\r\n\r\nexport default function _Layout() {\r\n  const { Header, Sider, Content } = Layout;\r\n  return (\r\n    <div className=\"container\">\r\n      <Layout>\r\n        <Header>\r\n          <h1>\r\n            <NavLink to=\"/\">猫眼电影管理系统</NavLink>\r\n          </h1>\r\n        </Header>\r\n        <Layout>\r\n          <Sider>\r\n            <Menu theme=\"dark\">\r\n              <Menu.Item key=\"2\">\r\n                <NavLink to=\"/movie\">电影列表页</NavLink>\r\n              </Menu.Item>\r\n              <Menu.Item key=\"3\">\r\n                <NavLink to=\"/movie/add\">添加电影页</NavLink>\r\n              </Menu.Item>\r\n            </Menu>\r\n          </Sider>\r\n          <Content>\r\n            <div className=\"content\">\r\n              <Route path=\"/\" exact component={Home} />\r\n              <Route path=\"/movie\" exact component={MovieList} />\r\n              <Route path=\"/movie/add\" component={AddMovie} />\r\n              <Route path=\"/movie/edit/:id\" component={EditMovie} />\r\n            </div>\r\n          </Content>\r\n        </Layout>\r\n      </Layout>\r\n    </div>\r\n  );\r\n}\r\n","/* eslint { \"import/no-anonymous-default-export\": off } */\r\nimport { IMovie } from \"../../services/MovieService\";\r\nimport { ISearchCondition } from \"../../services/CommonTypes\";\r\nimport { DeleteMovieAction, MovieAction, SaveMovieAction, SetConditionAction, SetLoadingAction, SwitchChangeAction } from \"../actions/MovieAction\";\r\n\r\nexport type IMovieCondition = Required<ISearchCondition>;\r\n\r\n/**\r\n * 电影的状态\r\n */\r\nexport interface IMovieState {\r\n  /**\r\n   * 电影的数组\r\n   */\r\n  data: IMovie[];\r\n  /**\r\n   * 查询条件\r\n   */\r\n  condition: IMovieCondition;\r\n  /**\r\n   * 电影总数\r\n   */\r\n  total: number;\r\n  /**\r\n   * 是否为正在加载中\r\n   */\r\n  isLoading: boolean;\r\n  /**\r\n   * 总页数\r\n   */\r\n  totalPage: number;\r\n}\r\n\r\nconst initialState: IMovieState = {\r\n  data: [],\r\n  condition: {\r\n    key: \"\",\r\n    page: 1,\r\n    limit: 10,\r\n  },\r\n  total: 0,\r\n  isLoading: false,\r\n  totalPage: 0,\r\n};\r\n\r\n/**\r\n * 保存电影的操作\r\n * @param state\r\n * @param action\r\n * @returns\r\n */\r\nfunction saveMovie(state: IMovieState, action: SaveMovieAction): IMovieState {\r\n  return {\r\n    ...state,\r\n    data: action.payload.movies,\r\n    total: action.payload.total,\r\n    totalPage: Math.ceil(action.payload.total / state.condition.limit),\r\n  };\r\n}\r\n\r\n/**\r\n * 删除电影操作\r\n * @param state\r\n * @param action\r\n * @returns\r\n */\r\nfunction deleteMovie(state: IMovieState, action: DeleteMovieAction): IMovieState {\r\n  return {\r\n    ...state,\r\n    data: state.data.filter(m => m._id !== action.payload),\r\n    total: state.total - 1,\r\n    totalPage: Math.ceil((state.total - 1) / state.condition.limit),\r\n  };\r\n}\r\n\r\n/**\r\n * 设置查询条件操作\r\n * @param state\r\n * @param action\r\n * @returns\r\n */\r\nfunction setCondition(state: IMovieState, action: SetConditionAction): IMovieState {\r\n  const newCondition = {\r\n    ...state,\r\n    condition: {\r\n      ...state.condition,\r\n      ...action.payload,\r\n    },\r\n  };\r\n  newCondition.totalPage = Math.ceil(newCondition.total / newCondition.condition.limit);\r\n  return newCondition;\r\n}\r\n\r\n/**\r\n * 设置是否正在加载中操作\r\n * @param state\r\n * @param action\r\n * @returns\r\n */\r\nfunction setLoading(state: IMovieState, action: SetLoadingAction): IMovieState {\r\n  return {\r\n    ...state,\r\n    isLoading: action.payload,\r\n  };\r\n}\r\n\r\nfunction switchChange(state: IMovieState, action: SwitchChangeAction): IMovieState {\r\n  const movie = state.data.find(m => m._id === action.payload.id);\r\n  if (!movie) {\r\n    return state;\r\n  }\r\n\r\n  const newMovie = { ...movie, [action.payload.type]: action.payload.value };\r\n\r\n  const newData = state.data.map(d => {\r\n    if (d._id === action.payload.id) {\r\n      return newMovie;\r\n    }\r\n    return d;\r\n  });\r\n\r\n  return {\r\n    ...state,\r\n    data: newData,\r\n  };\r\n}\r\n\r\nexport default (state: IMovieState = initialState, action: MovieAction): IMovieState => {\r\n  switch (action.type) {\r\n    case \"SAVE_MOVIE\":\r\n      return saveMovie(state, action);\r\n    case \"DELETE_MOVIE\":\r\n      return deleteMovie(state, action);\r\n    case \"SET_CONDITION\":\r\n      return setCondition(state, action);\r\n    case \"SET_LOADING\":\r\n      return setLoading(state, action);\r\n    case \"SWITCH_CHANGE\":\r\n      return switchChange(state, action);\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n","import { combineReducers } from \"redux\";\r\nimport Movie, { IMovieState } from \"./MovieReducer\";\r\n\r\nexport interface IRootState {\r\n  Movie: IMovieState;\r\n}\r\nexport default combineReducers({\r\n  Movie,\r\n});\r\n","import { applyMiddleware, createStore } from \"redux\";\r\nimport reducer, { IRootState } from \"./reducers\";\r\nimport logger from \"redux-logger\";\r\nimport thunk, { ThunkMiddleware } from \"redux-thunk\";\r\n\r\nexport const store = createStore(reducer, applyMiddleware(thunk as ThunkMiddleware<IRootState>, logger));\r\n","import React from \"react\";\nimport { BrowserRouter, Route } from \"react-router-dom\";\nimport Layout from \"./pages/Layout\";\nimport { Provider } from \"react-redux\";\nimport { store } from \"./redux\";\n\nfunction App() {\n  return (\n    <Provider store={store}>\n      <BrowserRouter>\n        <Route path=\"/\" component={Layout} />\n      </BrowserRouter>\n    </Provider>\n  );\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport \"antd/dist/antd.css\";\nimport App from \"./App\";\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n"],"sourceRoot":""}